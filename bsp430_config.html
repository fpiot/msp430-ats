<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BSP430: BSP430 Configuration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BSP430
   &#160;<span id="projectnumber">20120921</span>
   </div>
   <div id="projectbrief">Board Support Package for MSP430 microcontrollers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">BSP430 Configuration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#cfg_placement">Placement of Configuration Information</a></li>
<li class="level1"><a href="#cfg_use">Use of Configuration-Dependent Information</a></li>
<li class="level1"><a href="#cfg_module">Checking for Module Capabilities</a></li>
</ul>
</div>
<div class="textblock"><p>The BSP430 configuration structure is implemented using the standard C preprocessor. As a general rule, if an application wishes to use a peripheral, it specifies this by defining a macro to 1. The specific peripheral, and the desired capability, are reflected in the macro name.</p>
<p>For example, to use the <a class="el" href="layer.html#HPL">HPL</a> interface to digital I/O port 1 it is necessary to define <a class="el" href="port_8h.html#ae2fc54db8e042a1a968b60deddfe065c">configBSP430_HPL_PORT1</a>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define configBSP430_HPL_PORT1 1</span></div>
</div><!-- fragment --><p>If the <a class="el" href="layer.html#HAL">HAL</a> interface is desired, that must be requested using:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define configBSP430_HAL_PORT1 1</span></div>
</div><!-- fragment --><p>The HAL interface will always depend on the corresponding HPL interface, but BSP430 will automatically enable the underlying capabilities by default, so you don't need to ask for them explicitly.</p>
<p>Failure to correctly request a resource that your application depends on will result in either compile-time or link-time errors.</p>
<h1><a class="anchor" id="cfg_placement"></a>
Placement of Configuration Information</h1>
<p>Because the BSP430 infrastructure enables and disables features within separate object files based on the flags presented at the time the source file is compiled, it is critical that all object files in an application have consistent flag definitions.</p>
<p>Each header in BSP430 that does not include another BSP430 file includes the file <a class="el" href="core_8h.html" title="Common header included by all BSP430 leaf headers.">bsp430/core.h</a>. Subject to <a class="el" href="core_8h.html#ab63537e5c8c1fa94b5d3cbdfc53d9220">configBSP430_CORE_INCLUDE_BSP430_CONFIG_FILE</a>, the first thing this file does is:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;bsp430_config.h&quot;</span></div>
</div><!-- fragment --><p>Unlike all other BSP430 headers, this file is not accessed with a path that places it within the BSP430 hierarchy, and is assumed to exist within the application source area. It is in this file that application-specific configuration information should be placed.</p>
<p>The application-specific configuration file should end with:</p>
<div class="fragment"><div class="line"><span class="comment">/* Include platform defaults */</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="bsp430__config_8h.html" title="BSP430 configuration directives for generic platform support.">bsp430/platform/bsp430_config.h</a>&gt;</span></div>
</div><!-- fragment --><p>This file consults the existing definitions (e.g. <a class="el" href="platform_8h.html#ababc41a3cb834f76137a81137c75f484">BSP430_PLATFORM_EXP430G2</a> or <a class="el" href="platform_8h.html#a33caa59d1913e09742abeefb9d00aad2">BSP430_PLATFORM_CUSTOM</a>) to identify a platform-specific configuration file, which it then includes. In that file any previous requests for specific features, such as <a class="el" href="timer_8h.html#a21a5d22e80e4fecc6242b1530632ba85">configBSP430_TIMER_CCACLK</a>, are translated to requests for the underlying peripheral supported on that platform.</p>
<p>Finally, each header that specifies a configuration option sets a default for that option if no previous header or the environment provided an explicit request for or rejection of the option.</p>
<h1><a class="anchor" id="cfg_use"></a>
Use of Configuration-Dependent Information</h1>
<p>As a general rule, an option <b>configBSP430_FOO</b> serves as an indication that an application or library function requests that the named feature be made available. It is <b>not</b> a guarantee that the feature could be provided; for example, <a class="el" href="timer_8h.html#a21a5d22e80e4fecc6242b1530632ba85">configBSP430_TIMER_CCACLK</a> requests a timer be assigned that supports capturing events when an ACLK-based timer tick occurs, but whether such a timer is available is dependent on whether the platform headers define one.</p>
<p>When this general rule applies, application code should check <b>BSP430_FOO</b> to see whether the request made through <b>configBSP430_FOO</b> could be satisfied. In the documentation, there will be (for example) an <b>Affects</b> link from <a class="el" href="timer_8h.html#a21a5d22e80e4fecc6242b1530632ba85">configBSP430_TIMER_CCACLK</a> to <a class="el" href="timer_8h.html#afaa65b8c2e6832c51e73ab8c929af856">BSP430_TIMER_CCACLK</a> and a <b>Dependency</b> link in the reverse direction. In cases where the affected macro is a C preprocessor symbol it should be checked following the standard for those macros:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#if BSP430_TIMER_CCACLK - 0</span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* The capture/compare-on-aclk feature is available */</span></div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* BSP430_TIMER_CCACLK */</span><span class="preprocessor"></span></div>
</div><!-- fragment --><p>In other cases like <a class="el" href="port_8h.html#a5afcb529d6a3d330aa4c79c634ec429e">configBSP430_HPL_PORT7</a> simple use of the feature (viz., reference to <a class="el" href="port_8h.html#a211c90a9d207b2dff496de31f2aa8c4d">BSP430_HPL_PORT7</a>) will produce a compile-time error if the requested feature is not available on the target, so it is generally not necessary to explicitly check for success.</p>
<p>Some configuration macros such as <a class="el" href="timer_8h.html#a2d9f6514833dda162d50bc1616863793">configBSP430_TIMER_CCACLK_USE_DEFAULT_RESOURCE</a> serve only to influence a choice of solution, and there is no specific facility to determine whether the setting was successful. For these macros there is no <b>Affects</b> annotation in the documentation.</p>
<h1><a class="anchor" id="cfg_module"></a>
Checking for Module Capabilities</h1>
<p>Internally BSP430 checks functional presence macro definitions that are internal to the MCU-specific headers provided by Texas Instruments. In some cases, it may be desirable to detect whether a feature is present without hard-coding checks of those internal macros.</p>
<p>As an example, the Power Management Module is only available on certain 5xx/6xx family MCUs. Rather than attempting to detect that situation and conditionally including <a class="el" href="pmm_8h.html" title="Hardware presentation/abstraction for Power Management Module (PMM).">bsp430/periph/pmm.h</a>, the module header will do this and define a macro <a class="el" href="pmm_8h.html#af9f6a1ab23247e37c030abdfef888798">BSP430_MODULE_PMM</a> that has a non-zero value only if the module is available. Thus you may use:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="pmm_8h.html" title="Hardware presentation/abstraction for Power Management Module (PMM).">bsp430/periph/pmm.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#if BSP430_MODULE_PMM - 0</span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* Include declarations related to LPMx.5 mode */</span></div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* BSP430_MODULE_PMM */</span><span class="preprocessor"></span></div>
</div><!-- fragment --><p>Copyright 2012, Peter A. Bigot </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Sep 21 2012 12:37:44 for BSP430 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
